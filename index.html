<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lisis de Apuestas Deportivas 2025-2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        .controls {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
        }
        label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
        }
        select, input, button {
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        .btn-export {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }
        .btn-export:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
        }
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            font-size: 18px;
            color: #667eea;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .results {
            padding: 30px;
        }
        .match-analysis {
            background: white;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 1px solid #e9ecef;
        }
        .match-header {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .match-teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.5em;
            font-weight: 700;
        }
        .vs {
            font-size: 1.2em;
            opacity: 0.8;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 30px;
        }
        .stats-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            border-left: 5px solid #667eea;
        }
        .stats-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #495057;
            margin-bottom: 15px;
            text-align: center;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #dee2e6;
        }
        .stat-row:last-child {
            border-bottom: none;
        }
        .stat-label {
            font-weight: 600;
            color: #6c757d;
        }
        .stat-value {
            font-weight: 700;
            color: #495057;
        }
        .prediction-box {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
        }
        .prediction-title {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .prediction-value {
            font-size: 2em;
            font-weight: 900;
        }
        .spreadsheet-container {
            margin-top: 40px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        .spreadsheet-header {
            background: linear-gradient(135deg, #6f42c1 0%, #6610f2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .table-container {
            overflow-x: auto;
            max-height: 600px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        th, td {
            padding: 12px 8px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        th {
            background: #f8f9fa;
            font-weight: 700;
            color: #495057;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        tr:hover {
            background: #e3f2fd;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #dc3545;
        }
        .success {
            background: #d1ecf1;
            color: #0c5460;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #17a2b8;
        }
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            .controls {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            .stats-grid {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ An√°lisis de Apuestas Deportivas 2025-2026</h1>
            <p>Sistema Avanzado de An√°lisis Estad√≠stico para M√∫ltiples Ligas</p>
        </div>
        <div class="controls">
            <div class="control-group">
                <label for="league">Liga</label>
                <select id="league" onchange="loadTeams()">
                    <option value="">Seleccionar Liga</option>
                    <optgroup label="Am√©rica">
                        <option value="MLS">MLS (Estados Unidos)</option>
                        <option value="LigaMX">Liga MX (M√©xico)</option>
                        <option value="LigaFPD">Liga FPD (Costa Rica)</option>
                        <option value="LigaBetPlay">Liga BetPlay (Colombia)</option>
                        <option value="LigaProEC">Liga Pro (Ecuador)</option>
                        <option value="Liga1PE">Liga 1 (Per√∫)</option>
                        <option value="PrimeraDivisionCL">Primera Divisi√≥n (Chile)</option>
                        <option value="LigaProfesionalAR">Liga Profesional (Argentina)</option>
                        <option value="Brasileirao">Brasileir√£o (Brasil)</option>
                        <option value="PrimeraDivisionUY">Primera Divisi√≥n (Uruguay)</option>
                    </optgroup>
                    <optgroup label="Europa">
                        <option value="Allsvenskan">Allsvenskan (Suecia)</option>
                        <option value="ProLeague">Pro League (B√©lgica)</option>
                        <option value="SuperligaDK">Superliga (Dinamarca)</option>
                        <option value="Liga1RO">Liga 1 (Rumania)</option>
                        <option value="Ekstraklasa">Ekstraklasa (Polonia)</option>
                        <option value="SuperLeagueCH">Super League (Suiza)</option>
                        <option value="Ligue1">Ligue 1 (Francia)</option>
                        <option value="LaLiga">La Liga (Espa√±a)</option>
                        <option value="SerieA">Serie A (Italia)</option>
                        <option value="PrimeiraLiga">Primeira Liga (Portugal)</option>
                        <option value="Eredivisie">Eredivisie (Pa√≠ses Bajos)</option>
                        <option value="SuperLig">S√ºper Lig (Turqu√≠a)</option>
                        <option value="PremierLeague">Premier League (Inglaterra)</option>
                        <option value="Championship">Championship (Inglaterra)</option>
                        <option value="Premiership">Premiership (Escocia)</option>
                        <option value="Bundesliga">Bundesliga (Alemania)</option>
                        <option value="Bundesliga2">2. Bundesliga (Alemania)</option>
                    </optgroup>
                </select>
            </div>
            <div class="control-group">
                <label for="season">Temporada</label>
                <select id="season">
                    <option value="2025">2025</option>
                    <option value="2024">2024</option>
                </select>
            </div>
            <div class="control-group">
                <label for="homeTeam">Equipo Local</label>
                <select id="homeTeam">
                    <option value="">Seleccionar equipo local</option>
                </select>
            </div>
            <div class="control-group">
                <label for="awayTeam">Equipo Visitante</label>
                <select id="awayTeam">
                    <option value="">Seleccionar equipo visitante</option>
                </select>
            </div>
            <div class="control-group">
                <button class="btn-primary" onclick="analyzeMatch()">üîç Analizar Partido</button>
            </div>
            <div class="control-group">
                <button class="btn-export" onclick="exportToExcel()">üìä Exportar a Excel</button>
            </div>
            <div class="control-group">
                <button onclick="showPricingInfo()" style="background: linear-gradient(135deg, #ffc107 0%, #ff8f00 100%); color: white; border: none; cursor: pointer; padding: 12px; border-radius: 10px; font-weight: 600;">üí∞ Planes y Precios</button>
            </div>
        </div>
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Cargando datos...</p>
        </div>
        <div class="results" id="results"></div>
        <div class="spreadsheet-container" id="spreadsheetContainer" style="display: none;">
            <div class="spreadsheet-header">
                <h2>üìä Hoja de C√°lculo de Estad√≠sticas</h2>
            </div>
            <div class="table-container">
                <table id="statsTable">
                    <thead id="tableHeader"></thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
        let currentData = null;

        // Datos simulados de equipos por liga
        const mockTeams = {
            "MLS": ["LA Galaxy", "Seattle Sounders", "New York City FC", "Atlanta United", "LAFC", "Portland Timbers", "New England Revolution", "Sporting Kansas City", "D.C. United", "Orlando City SC", "New York Red Bulls", "Austin FC", "Colorado Rapids", "FC Dallas", "Houston Dynamo", "Inter Miami CF", "Minnesota United", "Nashville SC", "Philadelphia Union", "Real Salt Lake", "San Jose Earthquakes", "Columbus Crew", "Charlotte FC", "CF Montr√©al", "Toronto FC", "Chicago Fire", "FC Cincinnati", "Vancouver Whitecaps", "St. Louis City SC"],
            "LigaMX": ["Am√©rica", "Chivas", "Tigres", "Monterrey", "Pumas", "Toluca", "Cruz Azul", "Santos Laguna", "Puebla", "Pachuca", "Le√≥n", "Necaxa", "Atlas", "Mazatl√°n", "Quer√©taro", "San Luis", "Tijuana", "Ju√°rez", "Monarcas Morelia", "Atl√©tico San Luis"],
            "LigaFPD": ["LD Alajuelense", "CS Herediano", "Deportivo Saprissa", "CS Cartagin√©s", "AD San Carlos", "ADR Jicaral", "Municipal P√©rez Zeled√≥n", "Municipal Grecia", "Sporting FC", "AD Guanacasteca", "Puntarenas FC", "ADR Jicaral"],
            "LigaBetPlay": ["Millonarios", "Atl√©tico Nacional", "Deportivo Cali", "Santa Fe", "Junior", "Am√©rica de Cali", "Deportes Tolima", "La Equidad", "Once Caldas", "Envigado FC", "Patriotas", "Jaguares", "Alianza Petrolera", "Deportivo Pasto", "Atl√©tico Bucaramanga", "Rionegro √Åguilas", "Boyac√° Chic√≥", "Deportivo Pereira", "Atl√©tico Huila", "Cortulu√°"],
            "LigaProEC": ["Barcelona SC", "LDU Quito", "Emelec", "Independiente del Valle", "Aucas", "Deportivo Cuenca", "Universidad Cat√≥lica", "El Nacional", "T√©cnico Universitario", "Mushuc Runa", "Delf√≠n SC", "Guayaquil City", "Orense SC", "Macar√°", "Gualaceo SC", "9 de Octubre", "Cumbay√° FC", "Imbabura SC"],
            "Liga1PE": ["Alianza Lima", "Universitario", "Sporting Cristal", "Melgar", "Cienciano", "Sport Boys", "Universidad C√©sar Vallejo", "Deportivo Municipal", "Binacional", "Carlos A. Mannucci", "UTC", "Ayacucho FC", "Sport Huancayo", "Cusco FC", "Alianza Atl√©tico", "Deportivo Coopsol", "Pirata FC", "Academia Cantolao", "Comerciantes Unidos", "ADT"],
            "PrimeraDivisionCL": ["Colo-Colo", "Universidad Cat√≥lica", "Universidad de Chile", "Palestino", "O'Higgins", "Uni√≥n Espa√±ola", "Audax Italiano", "Huachipato", "Coquimbo Unido", "Everton", "Deportes La Serena", "√ëublense", "Deportes Antofagasta", "Deportes Iquique", "Curic√≥ Unido", "Deportes Copiap√≥"],
            "LigaProfesionalAR": ["Boca Juniors", "River Plate", "Racing Club", "Independiente", "San Lorenzo", "V√©lez Sarsfield", "Argentinos Juniors", "Estudiantes", "Lan√∫s", "Talleres", "Rosario Central", "Newell's Old Boys", "Gimnasia y Esgrima LP", "Hurac√°n", "Banfield", "Central C√≥rdoba", "Arsenal", "Platense", "Barracas Central", "Sarmiento", "Defensa y Justicia", "Tigre", "Uni√≥n", "Godoy Cruz", "Patronato", "Instituto"],
            "Brasileirao": ["Flamengo", "Palmeiras", "S√£o Paulo", "Corinthians", "Fluminense", "Vasco da Gama", "Atl√©tico Mineiro", "Santos", "Internacional", "Gr√™mio", "Botafogo", "Cruzeiro", "Athletico Paranaense", "Red Bull Bragantino", "Fortaleza", "Cuiab√°", "Goi√°s", "Am√©rica Mineiro", "Coritiba", "Bahia"],
            "PrimeraDivisionUY": ["Pe√±arol", "Nacional", "Liverpool", "Defensor Sporting", "Wanderers", "Danubio", "Cerro Largo", "F√©nix", "River Plate", "Deportivo Maldonado", "Boston River", "Cerrito", "Rentistas", "Albion", "La Luz", "Plaza Colonia"],
            "Allsvenskan": ["Malm√∂ FF", "AIK", "Djurg√•rdens IF", "Hammarby IF", "IFK G√∂teborg", "IF Elfsborg", "IFK Norrk√∂ping", "IK Sirius", "H√§cken", "V√§rnamo", "Kalmar FF", "Degerfors IF", "Mj√§llby AIF", "Helsingborgs IF", "Varbergs BoIS", "Halmia"],
            "ProLeague": ["Club Brugge", "RSC Anderlecht", "Royal Antwerp", "KRC Genk", "Standard Li√®ge", "KAA Gent", "Union Saint-Gilloise", "OH Leuven", "Cercle Brugge", "KV Mechelen", "KV Oostende", "RFC Seraing", "SV Zulte Waregem", "KAS Eupen", "RWD Molenbeek", "Sporting Charleroi"],
            "SuperligaDK": ["FC Copenhagen", "Br√∏ndby IF", "FC Midtjylland", "AGF Aarhus", "FC Nordsj√¶lland", "Randers FC", "Odense BK", "Viborg FF", "Silkeborg IF", "AaB", "Lyngby BK", "Hvidovre IF"],
            "Liga1RO": ["FCSB", "CFR Cluj", "Universitatea Craiova", "Rapid Bucure»ôti", "Sepsi OSK", "FCV Farul Constan»õa", "FC U Craiova 1948", "FC Hermannstadt", "FC Arge»ô", "FC Voluntari", "FC UTA Arad", "FC Petrolul Ploie»ôti", "FC Dinamo Bucure»ôti", "FC Politehnica Ia»ôi", "FC Chindia T√¢rgovi»ôte", "FC Mioveni"],
            "Ekstraklasa": ["Legia Warsaw", "Lech Pozna≈Ñ", "Pogo≈Ñ Szczecin", "Rak√≥w Czƒôstochowa", "≈ölƒÖsk Wroc≈Çaw", "Piast Gliwice", "Lechia Gda≈Ñsk", "Warta Pozna≈Ñ", "Jagiellonia Bia≈Çystok", "Cracovia", "Wis≈Ça P≈Çock", "G√≥rnik Zabrze", "Zag≈Çƒôbie Lubin", "Radomiak Radom", "Wis≈Ça Krak√≥w", "Bruk-Bet Termalica Nieciecza", "Mied≈∫ Legnica", "Korona Kielce"],
            "SuperLeagueCH": ["Young Boys", "Servette FC", "FC Basel", "FC Z√ºrich", "FC Lugano", "FC St. Gallen", "FC Luzern", "Grasshopper Club Z√ºrich", "FC Sion", "FC Lausanne-Sport", "FC Winterthur", "FC Stade Nyonnais"],
            "Ligue1": ["Paris Saint-Germain", "Olympique de Marseille", "AS Monaco", "OGC Nice", "Olympique Lyonnais", "Stade Rennais", "LOSC Lille", "RC Lens", "FC Nantes", "Stade de Reims", "Montpellier HSC", "RC Strasbourg", "FC Lorient", "Stade Brestois", "Toulouse FC", "FC Metz", "Clermont Foot", "Le Havre AC"],
            "LaLiga": ["Real Madrid", "FC Barcelona", "Atl√©tico Madrid", "Real Sociedad", "Villarreal CF", "Real Betis", "Athletic Club", "Sevilla FC", "Girona FC", "Rayo Vallecano", "CA Osasuna", "Valencia CF", "RCD Mallorca", "C√°diz CF", "UD Almer√≠a", "Getafe CF", "Celta de Vigo", "Granada CF", "UD Las Palmas", "Deportivo Alav√©s"],
            "SerieA": ["Inter Milan", "AC Milan", "Juventus", "Napoli", "Roma", "Lazio", "Atalanta", "Fiorentina", "Torino", "Bologna", "Sassuolo", "Udinese", "Monza", "Empoli", "Hellas Verona", "Lecce", "Salernitana", "Cremonese", "Spezia", "Sampdoria"],
            "PrimeiraLiga": ["Benfica", "Porto", "Sporting CP", "SC Braga", "Vit√≥ria SC", "FC Arouca", "Boavista FC", "Vit√≥ria de Guimar√£es", "Moreirense FC", "Rio Ave FC", "GD Chaves", "FC Famalic√£o", "GD Estoril Praia", "FC Pa√ßos de Ferreira", "CS Mar√≠timo", "FC Vizela", "Portimonense SC", "Casa Pia AC"],
            "Eredivisie": ["Ajax", "PSV Eindhoven", "Feyenoord", "AZ Alkmaar", "Twente", "PEC Zwolle", "Vitesse", "Utrecht", "Heerenveen", "Groningen", "Sparta Rotterdam", "Fortuna Sittard", "NEC Nijmegen", "Cambuur", "Go Ahead Eagles", "Excelsior", "Volendam", "Emmen"],
            "SuperLig": ["Galatasaray", "Fenerbah√ße", "Be≈üikta≈ü", "Trabzonspor", "Ba≈üak≈üehir", "Adana Demirspor", "Alanyaspor", "Sivasspor", "Konyaspor", "Kasƒ±mpa≈üa", "Gaziantep FK", "Antalyaspor", "Kayserispor", "Hatayspor", "Giresunspor", "√úmraniyespor", "ƒ∞stanbulspor", "Ankarag√ºc√º"],
            "PremierLeague": ["Manchester City", "Arsenal", "Liverpool", "Manchester United", "Chelsea", "Tottenham Hotspur", "Newcastle United", "Aston Villa", "Brighton & Hove Albion", "Brentford", "Fulham", "Crystal Palace", "Wolverhampton Wanderers", "West Ham United", "Bournemouth", "Nottingham Forest", "Everton", "Luton Town", "Burnley", "Sheffield United"],
            "Championship": ["Leicester City", "Leeds United", "Ipswich Town", "Southampton", "West Bromwich Albion", "Norwich City", "Coventry City", "Sunderland", "Cardiff City", "Preston North End", "Middlesbrough", "Hull City", "Blackburn Rovers", "Watford", "Swansea City", "Queens Park Rangers", "Millwall", "Birmingham City", "Rotherham United", "Sheffield Wednesday", "Stoke City", "Bristol City", "Plymouth Argyle", "Huddersfield Town"],
            "Premiership": ["Celtic", "Rangers", "Heart of Midlothian", "Aberdeen", "Hibernian", "St Mirren", "Motherwell", "Dundee FC", "Livingston", "Kilmarnock", "St Johnstone", "Ross County"],
            "Bundesliga": ["Bayern Munich", "Bayer Leverkusen", "Borussia Dortmund", "RB Leipzig", "VfB Stuttgart", "Eintracht Frankfurt", "TSG Hoffenheim", "SC Freiburg", "VfL Wolfsburg", "Borussia M√∂nchengladbach", "1. FC Union Berlin", "1. FSV Mainz 05", "1. FC K√∂ln", "FC Augsburg", "SV Werder Bremen", "VfL Bochum", "Hertha BSC", "FC Schalke 04"],
            "Bundesliga2": ["1. FC Kaiserslautern", "Hamburger SV", "Fortuna D√ºsseldorf", "1. FC N√ºrnberg", "SC Paderborn 07", "Holstein Kiel", "Hannover 96", "Karlsruher SC", "1. FC Magdeburg", "Eintracht Braunschweig", "SV Elversberg", "VfL Osnabr√ºck", "SpVgg Greuther F√ºrth", "1. FC Heidenheim", "Arminia Bielefeld", "SV Sandhausen", "SSV Jahn Regensburg", "Hansa Rostock"]
        };

        // Funci√≥n para mostrar/ocultar loading
        function showLoading(show) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // Funci√≥n para mostrar errores
        function showError(message) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `<div class="error">‚ùå ${message}</div>`;
        }

        // Funci√≥n para mostrar mensajes de √©xito
        function showSuccess(message) {
            const resultsDiv = document.getElementById('results');
            const currentContent = resultsDiv.innerHTML;
            resultsDiv.innerHTML = `<div class="success">‚úÖ ${message}</div>` + currentContent;
            setTimeout(() => {
                const successDiv = resultsDiv.querySelector('.success');
                if (successDiv) {
                    successDiv.remove();
                }
            }, 5000);
        }

        // Funci√≥n para mostrar informaci√≥n de precios
        function showPricingInfo() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0,0,0,0.8); z-index: 10000; display: flex;
                align-items: center; justify-content: center; padding: 20px;
            `;

            modal.innerHTML = `
                <div style="
                    background: white; border-radius: 20px; padding: 40px;
                    max-width: 800px; width: 100%; max-height: 80vh; overflow-y: auto;
                    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                ">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h2 style="color: #2a5298; margin-bottom: 10px;">üìä API-Football - Planes y Precios 2025</h2>
                        <p style="color: #6c757d;">Obt√©n datos reales de f√∫tbol profesional</p>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="border: 2px solid #28a745; border-radius: 15px; padding: 25px; text-align: center;">
                            <h3 style="color: #28a745; margin-bottom: 15px;">üÜì GRATUITO</h3>
                            <div style="font-size: 2em; font-weight: bold; color: #28a745; margin-bottom: 10px;">$0</div>
                            <div style="color: #6c757d; margin-bottom: 20px;">por mes</div>
                            <ul style="text-align: left; padding-left: 20px; color: #495057;">
                                <li><strong>100 requests/d√≠a</strong></li>
                                <li>Datos de partidos en vivo</li>
                                <li>Estad√≠sticas b√°sicas</li>
                                <li>Historial limitado</li>
                                <li>Ideal para probar</li>
                            </ul>
                        </div>

                        <div style="border: 2px solid #667eea; border-radius: 15px; padding: 25px; text-align: center; background: linear-gradient(135deg, #667eea22, #764ba222);">
                            <h3 style="color: #667eea; margin-bottom: 15px;">‚≠ê MEGA</h3>
                            <div style="font-size: 2em; font-weight: bold; color: #667eea; margin-bottom: 10px;">$13.99</div>
                            <div style="color: #6c757d; margin-bottom: 20px;">por mes</div>
                            <ul style="text-align: left; padding-left: 20px; color: #495057;">
                                <li><strong>10,000 requests/d√≠a</strong></li>
                                <li>Todas las ligas mundiales</li>
                                <li>Estad√≠sticas avanzadas</li>
                                <li>Historial completo</li>
                                <li>Soporte prioritario</li>
                            </ul>
                        </div>

                        <div style="border: 2px solid #ffc107; border-radius: 15px; padding: 25px; text-align: center;">
                            <h3 style="color: #e68900; margin-bottom: 15px;">üèÜ ULTRA</h3>
                            <div style="font-size: 2em; font-weight: bold; color: #e68900; margin-bottom: 10px;">$27.99</div>
                            <div style="color: #6c757d; margin-bottom: 20px;">por mes</div>
                            <ul style="text-align: left; padding-left: 20px; color: #495057;">
                                <li><strong>100,000 requests/d√≠a</strong></li>
                                <li>Acceso ilimitado</li>
                                <li>Datos en tiempo real</li>
                                <li>API premium features</li>
                                <li>Soporte 24/7</li>
                            </ul>
                        </div>
                    </div>

                    <div style="background: #e3f2fd; padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                        <h4 style="color: #1565c0; margin-bottom: 15px;">üöÄ C√≥mo obtener tu API Key:</h4>
                        <ol style="color: #495057; padding-left: 20px;">
                            <li>Ve a <strong>api-football.com</strong></li>
                            <li>Crea una cuenta gratuita</li>
                            <li>Ve a tu dashboard</li>
                            <li>Copia tu API Key</li>
                            <li>P√©gala en el campo correspondiente arriba</li>
                        </ol>
                    </div>

                    <div style="text-align: center;">
                        <button onclick="window.open('https://api-football.com', '_blank')" style="
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white; border: none; padding: 15px 30px;
                            border-radius: 25px; font-weight: 600; cursor: pointer;
                        ">Obtener API Key</button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="
                            margin-left: 15px; background: #f8f9fa; color: #6c757d;
                            border: 2px solid #dee2e6; padding: 15px 30px; border-radius: 25px;
                            font-weight: 600; cursor: pointer;
                        ">Cerrar</button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        // Funci√≥n para cargar equipos
        function loadTeams() {
            const leagueId = document.getElementById('league').value;
            const homeSelect = document.getElementById('homeTeam');
            const awaySelect = document.getElementById('awayTeam');

            if (!leagueId) {
                showError('Por favor selecciona una liga.');
                return;
            }

            showLoading(true);

            // Simular carga de equipos
            setTimeout(() => {
                try {
                    if (!mockTeams[leagueId]) {
                        throw new Error('No se encontraron equipos para esta liga.');
                    }

                    homeSelect.innerHTML = '<option value="">Seleccionar equipo local</option>';
                    awaySelect.innerHTML = '<option value="">Seleccionar equipo visitante</option>';

                    mockTeams[leagueId].forEach(team => {
                        const option = `<option value="${team}">${team}</option>`;
                        homeSelect.innerHTML += option;
                        awaySelect.innerHTML += option;
                    });

                    showSuccess(`${mockTeams[leagueId].length} equipos cargados exitosamente.`);
                } catch (error) {
                    homeSelect.innerHTML = '<option value="">Error cargando equipos</option>';
                    awaySelect.innerHTML = '<option value="">Error cargando equipos</option>';
                    showError(error.message);
                } finally {
                    showLoading(false);
                }
            }, 800);
        }

        // Funci√≥n para analizar partido
        async function analyzeMatch() {
            const homeTeam = document.getElementById('homeTeam').value;
            const awayTeam = document.getElementById('awayTeam').value;
            const league = document.getElementById('league').selectedOptions[0].text;
            const season = document.getElementById('season').value;

            if (!homeTeam || !awayTeam) {
                showError('Por favor selecciona ambos equipos.');
                return;
            }

            if (homeTeam === awayTeam) {
                showError('No puedes seleccionar el mismo equipo como local y visitante.');
                return;
            }

            showLoading(true);
            clearResults();

            try {
                // Simular an√°lisis
                await new Promise(resolve => setTimeout(resolve, 1200));

                // Datos simulados para el an√°lisis
                currentData = {
                    homeTeam: {
                        name: homeTeam,
                        averagesGeneral: {
                            goals_for: Math.random() * 2 + 1,
                            goals_against: Math.random() * 1.5,
                            shots_total: Math.random() * 5 + 10,
                            shots_on_goal: Math.random() * 3 + 4,
                            corner_kicks: Math.random() * 3 + 4,
                            yellow_cards: Math.random() * 2 + 1,
                            fouls: Math.random() * 5 + 10,
                            offsides: Math.random() * 2 + 1,
                            matches_analyzed: 10
                        },
                        averagesAtHome: {
                            goals_for: Math.random() * 1.5 + 1.5,
                            goals_against: Math.random() * 1,
                            shots_total: Math.random() * 4 + 12,
                            shots_on_goal: Math.random() * 2 + 5,
                            corner_kicks: Math.random() * 2 + 5,
                            yellow_cards: Math.random() * 1.5 + 1,
                            fouls: Math.random() * 4 + 11,
                            offsides: Math.random() * 1.5 + 1.5,
                            matches_analyzed: 5
                        }
                    },
                    awayTeam: {
                        name: awayTeam,
                        averagesGeneral: {
                            goals_for: Math.random() * 1.5 + 1,
                            goals_against: Math.random() * 1.5 + 0.5,
                            shots_total: Math.random() * 4 + 10,
                            shots_on_goal: Math.random() * 2 + 4,
                            corner_kicks: Math.random() * 2 + 4,
                            yellow_cards: Math.random() * 1.5 + 1.5,
                            fouls: Math.random() * 4 + 12,
                            offsides: Math.random() * 1.5 + 1,
                            matches_analyzed: 10
                        },
                        averagesAway: {
                            goals_for: Math.random() * 1 + 0.8,
                            goals_against: Math.random() * 1.5 + 0.8,
                            shots_total: Math.random() * 3 + 9,
                            shots_on_goal: Math.random() * 2 + 3.5,
                            corner_kicks: Math.random() * 2 + 4,
                            yellow_cards: Math.random() * 1.5 + 2,
                            fouls: Math.random() * 4 + 13,
                            offsides: Math.random() * 1.5 + 1,
                            matches_analyzed: 5
                        }
                    },
                    h2h: {
                        averages: {
                            home: {
                                goals_for: Math.random() * 1.5 + 1.2,
                                goals_against: Math.random() * 1,
                                shots_total: Math.random() * 3 + 11,
                                shots_on_goal: Math.random() * 2 + 4.5,
                                corner_kicks: Math.random() * 2 + 5,
                                yellow_cards: Math.random() * 1 + 1.5,
                                fouls: Math.random() * 3 + 12,
                                offsides: Math.random() * 1 + 1.5
                            },
                            away: {
                                goals_for: Math.random() * 1 + 0.8,
                                goals_against: Math.random() * 1.5 + 1,
                                shots_total: Math.random() * 3 + 9,
                                shots_on_goal: Math.random() * 2 + 3.5,
                                corner_kicks: Math.random() * 2 + 4,
                                yellow_cards: Math.random() * 1 + 2,
                                fouls: Math.random() * 3 + 13,
                                offsides: Math.random() * 1 + 1
                            }
                        },
                        fixtures: []
                    },
                    league: league,
                    season: season,
                    analysisDate: new Date().toISOString()
                };

                displayResults(currentData);
                createSpreadsheet(currentData);
                showSuccess('An√°lisis completado exitosamente.');
            } catch (error) {
                showError('Error en el an√°lisis: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // Funci√≥n para mostrar resultados
        function displayResults(data) {
            const resultsDiv = document.getElementById('results');

            const html = `
                <div class="match-analysis">
                    <div class="match-header">
                        <div class="match-teams">
                            <span>üè† ${data.homeTeam.name}</span>
                            <span class="vs">VS</span>
                            <span>‚úàÔ∏è ${data.awayTeam.name}</span>
                        </div>
                        <p>${data.league} - Temporada ${data.season}</p>
                        <p style="opacity: 0.8; font-size: 0.9em;">An√°lisis realizado: ${new Date(data.analysisDate).toLocaleString()}</p>
                    </div>
                    <div class="stats-grid">
                        <div class="stats-section">
                            <div class="stats-title">üè† ${data.homeTeam.name} - Promedio General</div>
                            ${formatStatsDisplay(data.homeTeam.averagesGeneral)}
                        </div>
                        <div class="stats-section">
                            <div class="stats-title">‚úàÔ∏è ${data.awayTeam.name} - Promedio General</div>
                            ${formatStatsDisplay(data.awayTeam.averagesGeneral)}
                        </div>
                        <div class="stats-section">
                            <div class="stats-title">üèòÔ∏è ${data.homeTeam.name} - Como Local</div>
                            ${formatStatsDisplay(data.homeTeam.averagesAtHome)}
                        </div>
                        <div class="stats-section">
                            <div class="stats-title">üõ£Ô∏è ${data.awayTeam.name} - Como Visitante</div>
                            ${formatStatsDisplay(data.awayTeam.averagesAway)}
                        </div>
                        ${data.h2h.averages ? `
                        <div class="stats-section">
                            <div class="stats-title">ü§ù Historial H2H - ${data.homeTeam.name}</div>
                            ${formatStatsDisplay(data.h2h.averages.home)}
                        </div>
                        <div class="stats-section">
                            <div class="stats-title">ü§ù Historial H2H - ${data.awayTeam.name}</div>
                            ${formatStatsDisplay(data.h2h.averages.away)}
                        </div>
                        ` : ''}
                    </div>
                    ${generateAdvancedPredictions(data)}
                </div>
                <div class="match-analysis" style="margin-top: 20px;">
                    <div class="match-header" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">
                        <h3>üìä An√°lisis Comparativo Detallado</h3>
                    </div>
                    ${generateComparativeAnalysis(data)}
                </div>
            `;

            resultsDiv.innerHTML = html;
        }

        // Funci√≥n para formatear estad√≠sticas
        function formatStatsDisplay(averages) {
            if (!averages) return '<p>No hay datos disponibles</p>';

            return `
                <div class="stat-row">
                    <span class="stat-label">‚öΩ Goles a Favor</span>
                    <span class="stat-value">${averages.goals_for?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">ü•Ö Goles en Contra</span>
                    <span class="stat-value">${averages.goals_against?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">üéØ Remates Totales</span>
                    <span class="stat-value">${averages.shots_total?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">üé™ Remates a Puerta</span>
                    <span class="stat-value">${averages.shots_on_goal?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">üö© Tiros de Esquina</span>
                    <span class="stat-value">${averages.corner_kicks?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">üü® Tarjetas Amarillas</span>
                    <span class="stat-value">${averages.yellow_cards?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">‚ö†Ô∏è Faltas</span>
                    <span class="stat-value">${averages.fouls?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">üèÉ Fueras de Juego</span>
                    <span class="stat-value">${averages.offsides?.toFixed(1) || '0.0'}</span>
                </div>
                <div class="stat-row" style="border-top: 2px solid #667eea; margin-top: 10px; padding-top: 10px;">
                    <span class="stat-label">üìà Partidos Analizados</span>
                    <span class="stat-value">${averages.matches_analyzed || '0'}</span>
                </div>
            `;
        }

        // Funci√≥n para generar predicciones avanzadas
        function generateAdvancedPredictions(data) {
            const homeGeneralScore = calculateAdvancedTeamScore(data.homeTeam.averagesGeneral);
            const awayGeneralScore = calculateAdvancedTeamScore(data.awayTeam.averagesGeneral);
            const homeSpecificScore = calculateAdvancedTeamScore(data.homeTeam.averagesAtHome);
            const awaySpecificScore = calculateAdvancedTeamScore(data.awayTeam.averagesAway);

            const homeFinalScore = (homeGeneralScore * 0.6) + (homeSpecificScore * 0.4);
            const awayFinalScore = (awayGeneralScore * 0.6) + (awaySpecificScore * 0.4);
            const totalScore = homeFinalScore + awayFinalScore;
            const homeWinProb = totalScore > 0 ? (homeFinalScore / totalScore * 100) : 50;
            const awayWinProb = 100 - homeWinProb;

            const predictions = [];

            const avgGoalsPerMatch = (data.homeTeam.averagesAtHome?.goals_for || 0) +
                                    (data.awayTeam.averagesAway?.goals_against || 0);
            predictions.push({
                type: "Over/Under 2.5 Goles",
                prediction: avgGoalsPerMatch > 2.5 ? "Over 2.5" : "Under 2.5",
                confidence: Math.abs(avgGoalsPerMatch - 2.5) * 20 + 60
            });

            const homeScoring = (data.homeTeam.averagesAtHome?.goals_for || 0) > 0.8;
            const awayScoring = (data.awayTeam.averagesAway?.goals_for || 0) > 0.8;
            predictions.push({
                type: "Ambos Equipos Marcan",
                prediction: homeScoring && awayScoring ? "S√≠" : "No",
                confidence: (homeScoring && awayScoring) ? 75 : 65
            });

            const avgCorners = ((data.homeTeam.averagesAtHome?.corner_kicks || 0) +
                              (data.awayTeam.averagesAway?.corner_kicks || 0));
            predictions.push({
                type: "Total C√≥rners",
                prediction: avgCorners > 9 ? "Over 9.5" : "Under 9.5",
                confidence: Math.abs(avgCorners - 9.5) * 8 + 55
            });

            return `
                <div class="prediction-box">
                    <div class="prediction-title">üéØ Predicciones Avanzadas</div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div style="text-align: center;">
                            <h4>üèÜ Resultado Principal</h4>
                            <div class="prediction-value" style="font-size: 1.2em;">
                                ${homeWinProb > awayWinProb ?
                                    `${data.homeTeam.name} (${homeWinProb.toFixed(1)}%)` :
                                    `${data.awayTeam.name} (${awayWinProb.toFixed(1)}%)`}
                            </div>
                        </div>
                        ${predictions.map(pred => `
                            <div style="text-align: center;">
                                <h4>${pred.type}</h4>
                                <div style="font-size: 1.1em; font-weight: bold; color: #2a5298;">
                                    ${pred.prediction}
                                </div>
                                <div style="font-size: 0.9em; opacity: 0.8;">
                                    Confianza: ${pred.confidence.toFixed(0)}%
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Funci√≥n para calcular puntuaci√≥n avanzada de equipo
        function calculateAdvancedTeamScore(averages) {
            if (!averages) return 0;

            const attackScore = (averages.goals_for * 4) +
                               (averages.shots_on_goal * 1) +
                               (averages.corner_kicks * 0.5);

            const defenseScore = (averages.goals_against * -3) -
                                (averages.yellow_cards * 0.2);

            return attackScore + defenseScore;
        }

        // Funci√≥n para generar an√°lisis comparativo
        function generateComparativeAnalysis(data) {
            const comparisons = [
                {
                    stat: 'goals_for',
                    name: 'Poder Ofensivo',
                    homeValue: data.homeTeam.averagesAtHome?.goals_for || 0,
                    awayValue: data.awayTeam.averagesAway?.goals_for || 0,
                    unit: 'goles/partido'
                },
                {
                    stat: 'goals_against',
                    name: 'Solidez Defensiva',
                    homeValue: data.homeTeam.averagesAtHome?.goals_against || 0,
                    awayValue: data.awayTeam.averagesAway?.goals_against || 0,
                    unit: 'goles/partido',
                    inverted: true
                },
                {
                    stat: 'shots_on_goal',
                    name: 'Peligrosidad',
                    homeValue: data.homeTeam.averagesAtHome?.shots_on_goal || 0,
                    awayValue: data.awayTeam.averagesAway?.shots_on_goal || 0,
                    unit: 'tiros/partido'
                },
                {
                    stat: 'corner_kicks',
                    name: 'Dominio Territorial',
                    homeValue: data.homeTeam.averagesAtHome?.corner_kicks || 0,
                    awayValue: data.awayTeam.averagesAway?.corner_kicks || 0,
                    unit: 'c√≥rners/partido'
                }
            ];

            const comparisonHTML = comparisons.map(comp => {
                const diff = comp.homeValue - comp.awayValue;
                const maxValue = Math.max(comp.homeValue, comp.awayValue);
                const advantage = comp.inverted ?
                    (diff < -0.1 ? 'home' : diff > 0.1 ? 'away' : 'equal') :
                    (diff > 0.1 ? 'home' : diff < -0.1 ? 'away' : 'equal');

                return `
                    <div style="margin-bottom: 25px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                        <h4 style="text-align: center; margin-bottom: 15px; color: #495057;">${comp.name}</h4>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span style="font-weight: bold;">${data.homeTeam.name}: ${comp.homeValue.toFixed(1)} ${comp.unit}</span>
                            <span style="font-weight: bold;">${data.awayTeam.name}: ${comp.awayValue.toFixed(1)} ${comp.unit}</span>
                        </div>
                        <div style="background: #dee2e6; height: 20px; border-radius: 10px; overflow: hidden; position: relative;">
                            <div style="
                                position: absolute;
                                left: 0;
                                top: 0;
                                height: 100%;
                                width: ${maxValue > 0 ? (comp.homeValue / maxValue * 50) : 0}%;
                                background: linear-gradient(90deg, #667eea, #764ba2);
                                opacity: ${advantage === 'home' ? 1 : 0.6};
                            "></div>
                            <div style="
                                position: absolute;
                                right: 0;
                                top: 0;
                                height: 100%;
                                width: ${maxValue > 0 ? (comp.awayValue / maxValue * 50) : 0}%;
                                background: linear-gradient(90deg, #28a745, #20c997);
                                opacity: ${advantage === 'away' ? 1 : 0.6};
                            "></div>
                        </div>
                        <div style="text-align: center; margin-top: 8px; font-size: 0.9em;">
                            <strong>${advantage === 'home' ? `Ventaja: ${data.homeTeam.name}` :
                                     advantage === 'away' ? `Ventaja: ${data.awayTeam.name}` :
                                     'Equilibrado'}</strong>
                        </div>
                    </div>
                `;
            }).join('');

            return `<div style="padding: 30px;">${comparisonHTML}</div>`;
        }

        // Funci√≥n para crear hoja de c√°lculo
        function createSpreadsheet(data) {
            const container = document.getElementById('spreadsheetContainer');
            const tableHeader = document.getElementById('tableHeader');
            const tableBody = document.getElementById('tableBody');

            tableHeader.innerHTML = `
                <tr>
                    <th>Estad√≠stica</th>
                    <th>${data.homeTeam.name} (Local)</th>
                    <th>${data.awayTeam.name} (Visitante)</th>
                    <th>H2H ${data.homeTeam.name}</th>
                    <th>H2H ${data.awayTeam.name}</th>
                    <th>Promedio General</th>
                    <th>Diferencia</th>
                    <th>Predicci√≥n</th>
                </tr>
            `;

            const stats = [
                { key: 'shots_total', name: 'Remates Totales' },
                { key: 'shots_on_goal', name: 'Remates a Puerta' },
                { key: 'corner_kicks', name: 'Tiros de Esquina' },
                { key: 'yellow_cards', name: 'Tarjetas Amarillas' },
                { key: 'fouls', name: 'Faltas' },
                { key: 'offsides', name: 'Fueras de Juego' },
                { key: 'goals_for', name: 'Goles a Favor' },
                { key: 'goals_against', name: 'Goles en Contra' }
            ];

            let tableRows = '';
            stats.forEach(stat => {
                const homeValue = data.homeTeam.averagesGeneral[stat.key] || 0;
                const awayValue = data.awayTeam.averagesGeneral[stat.key] || 0;
                const h2hHomeValue = data.h2h.averages ? (data.h2h.averages.home[stat.key] || 0) : 0;
                const h2hAwayValue = data.h2h.averages ? (data.h2h.averages.away[stat.key] || 0) : 0;
                const average = (homeValue + awayValue) / 2;
                const difference = homeValue - awayValue;
                const prediction = difference > 0.5 ? '‚ÜóÔ∏è Local' : difference < -0.5 ? '‚ÜòÔ∏è Visitante' : '‚û°Ô∏è Parejo';

                tableRows += `
                    <tr>
                        <td><strong>${stat.name}</strong></td>
                        <td>${homeValue.toFixed(2)}</td>
                        <td>${awayValue.toFixed(2)}</td>
                        <td>${h2hHomeValue.toFixed(2)}</td>
                        <td>${h2hAwayValue.toFixed(2)}</td>
                        <td>${average.toFixed(2)}</td>
                        <td style="color: ${difference > 0 ? 'green' : difference < 0 ? 'red' : 'orange'}">${difference.toFixed(2)}</td>
                        <td>${prediction}</td>
                    </tr>
                `;
            });

            const homeTotalScore = calculateAdvancedTeamScore(data.homeTeam.averagesGeneral);
            const awayTotalScore = calculateAdvancedTeamScore(data.awayTeam.averagesGeneral);
            const totalDifference = homeTotalScore - awayTotalScore;

            tableRows += `
                <tr style="background: #e3f2fd; font-weight: bold;">
                    <td><strong>üèÜ PUNTUACI√ìN TOTAL</strong></td>
                    <td>${homeTotalScore.toFixed(2)}</td>
                    <td>${awayTotalScore.toFixed(2)}</td>
                    <td>-</td>
                    <td>-</td>
                    <td>${((homeTotalScore + awayTotalScore) / 2).toFixed(2)}</td>
                    <td style="color: ${totalDifference > 0 ? 'green' : totalDifference < 0 ? 'red' : 'orange'}">${totalDifference.toFixed(2)}</td>
                    <td>${totalDifference > 1 ? 'üè† Victoria Local' : totalDifference < -1 ? '‚úàÔ∏è Victoria Visitante' : 'ü§ù Empate'}</td>
                </tr>
            `;

            tableBody.innerHTML = tableRows;
            container.style.display = 'block';
        }

        // Funci√≥n para exportar a Excel
        function exportToExcel() {
            if (!currentData) {
                showError('No hay datos para exportar. Primero analiza un partido.');
                return;
            }

            const excelData = [];

            excelData.push(['AN√ÅLISIS DE APUESTAS DEPORTIVAS']);
            excelData.push([`${currentData.homeTeam.name} vs ${currentData.awayTeam.name}`]);
            excelData.push([`Liga: ${currentData.league} - Temporada: ${currentData.season}`]);
            excelData.push([]);

            excelData.push([
                'Estad√≠stica',
                `${currentData.homeTeam.name} (Local)`,
                `${currentData.awayTeam.name} (Visitante)`,
                `H2H ${currentData.homeTeam.name}`,
                `H2H ${currentData.awayTeam.name}`,
                'Promedio General',
                'Diferencia',
                'Predicci√≥n'
            ]);

            const stats = [
                { key: 'shots_total', name: 'Remates Totales' },
                { key: 'shots_on_goal', name: 'Remates a Puerta' },
                { key: 'corner_kicks', name: 'Tiros de Esquina' },
                { key: 'yellow_cards', name: 'Tarjetas Amarillas' },
                { key: 'fouls', name: 'Faltas' },
                { key: 'offsides', name: 'Fueras de Juego' },
                { key: 'goals_for', name: 'Goles a Favor' },
                { key: 'goals_against', name: 'Goles en Contra' }
            ];

            stats.forEach(stat => {
                const homeValue = currentData.homeTeam.averagesGeneral[stat.key] || 0;
                const awayValue = currentData.awayTeam.averagesGeneral[stat.key] || 0;
                const h2hHomeValue = currentData.h2h.averages ? (currentData.h2h.averages.home[stat.key] || 0) : 0;
                const h2hAwayValue = currentData.h2h.averages ? (currentData.h2h.averages.away[stat.key] || 0) : 0;
                const average = (homeValue + awayValue) / 2;
                const difference = homeValue - awayValue;
                const prediction = difference > 0.5 ? 'Local' : difference < -0.5 ? 'Visitante' : 'Parejo';

                excelData.push([
                    stat.name,
                    homeValue.toFixed(2),
                    awayValue.toFixed(2),
                    h2hHomeValue.toFixed(2),
                    h2hAwayValue.toFixed(2),
                    average.toFixed(2),
                    difference.toFixed(2),
                    prediction
                ]);
            });

            const homeTotalScore = calculateAdvancedTeamScore(currentData.homeTeam.averagesGeneral);
            const awayTotalScore = calculateAdvancedTeamScore(currentData.awayTeam.averagesGeneral);
            const totalDifference = homeTotalScore - awayTotalScore;

            excelData.push([]);
            excelData.push([
                'PUNTUACI√ìN TOTAL',
                homeTotalScore.toFixed(2),
                awayTotalScore.toFixed(2),
                '-',
                '-',
                ((homeTotalScore + awayTotalScore) / 2).toFixed(2),
                totalDifference.toFixed(2),
                totalDifference > 1 ? 'Victoria Local' : totalDifference < -1 ? 'Victoria Visitante' : 'Empate'
            ]);

            const csvContent = excelData.map(row =>
                row.map(cell =>
                    typeof cell === 'string' && cell.includes(',') ? `"${cell}"` : cell
                ).join(',')
            ).join('\n');

            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);

            link.setAttribute('href', url);
            link.setAttribute('download', `analisis_${currentData.homeTeam.name}_vs_${currentData.awayTeam.name}_${Date.now()}.csv`);
            link.style.visibility = 'hidden';

            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showSuccess('Archivo Excel exportado exitosamente.');
        }

        // Funci√≥n para limpiar resultados
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('spreadsheetContainer').style.display = 'none';
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            showSuccess('Sistema iniciado. Selecciona una liga y carga los equipos para comenzar.');
        });
    </script>
</body>
</html>
